<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Sample weewx stations</title>
  <link href="http://www.weewx.com/styles/style2.css" rel="stylesheet" type="text/css" />
  <style>
#container {
  width: 100%;
  padding-left: 0px;
  padding-right: 0px;
}
#masthead {
  float: none;
  margin-left: auto;
  margin-right: auto;
}
#content {
  float: none;
  width: 798px;
  margin-left: auto;
  margin-right: auto;
  padding: 4px;
}
#map_container {
  margin-top: 4px;
  margin-left: 10px;
  margin-right: 10px;
  padding: 4px;
  border-top: 1px solid #dcdcdc;
  border-right: 1px solid #a9a9a9;
  border-bottom: 1px solid #808080;
  border-left: 1px solid #a9a9a9;
  background-color: #fff;
}
#footer {
  margin-left: auto;
  margin-right: auto;
}
.location {
  font-family: Helvetic, Arial, sans-serif;
  font-size: 10pt;
  font-weight: bold;
}
.location_details {
  font-family: Helvetic, Arial, sans-serif;
  font-size: 8pt;
}
.details {
  font-style: italic;
  text-align: right;
  font-size: 80%;
}
.gm-style-iw {
  width: 250px;
}
table {
  width: 100%;
}
.alignright {
  text-align: right;
}
.oddrow {
  background-color: #f8f8f8;
}
.evenrow {
  background-color: #ffffff;
}
</style>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript">
var sites = [];

var infowindow = new google.maps.InfoWindow({
  content: 'nothing selected'
});

var map;

function initialize() {
  var latlng = new google.maps.LatLng(21.0,0.0);
  var settings = {
    zoom: 2,
    center: latlng,
    mapTypeControl: true,
    mapTypeControlOptions: {
      style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
    },
    navigationControl: true,
    navigationControlOptions: {
      style: google.maps.NavigationControlStyle.SMALL
    },
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map(document.getElementById("map_canvas"), settings);
  var s = document.getElementById('site_listing');
  var tbl = document.createElement('table');
  var tbdy = document.createElement('tbody');
  rowclass = 'oddrow';
  for (var i=0; i<sites.length; i++) {
    var title = 'untitled';
    if(sites[i].description.length > 0) {
      title = sites[i].description;
    } else {
      title = sites[i].url;
    }
    var pos = new google.maps.LatLng(sites[i].latitude, sites[i].longitude);
    var mkr = new google.maps.Marker({
      position: pos,
      map: map,
      title: title,
    });
    attachinfo(mkr, i);
    var tr = document.createElement('tr');
    var td = document.createElement('td');
    td.innerHTML = '<a href="' + sites[i].url + '">' + title + '</a><br/><small>' + sites[i].url + '</small>';
    tr.appendChild(td);
    var td = document.createElement('td');
    var date = new Date(sites[i].last_seen * 1000);
    td.className = 'alignright';
    td.innerHTML = sites[i].station + '<br/><small>' + date.toUTCString() + '</small>';
    tr.appendChild(td);
    tr.className = rowclass;
    tbdy.appendChild(tr);
    if(rowclass == 'oddrow') {
      rowclass = 'evenrow'
    } else {
      rowclass = 'oddrow'
    }
  }
  tbl.appendChild(tbdy);
  s.appendChild(tbl);
}

function attachinfo(marker, idx) {
  google.maps.event.addListener(marker, 'click', function() {
    var str = '<p class="location">';
    str += '<a href="' + sites[idx].url + '">';
    if(sites[idx].description.length > 0) {
      str += sites[idx].description;
    } else {
      str += sites[idx].url;
    }
    str += '</a></p>';
    str += '<p class="location_details">';
    str += sites[idx].latitude.toFixed(3) + ', ';
    str += sites[idx].longitude.toFixed(3) + '<br/>';
    str += sites[idx].station + '<br/>';
    str += '</p>';
    infowindow.setContent(str);
    infowindow.open(map, marker);
  });
}

function toggle(control, id) {
  elem = document.getElementById(id);
  if(elem) {
    var html = control.innerHTML;
    var display = 'none';
    var indicator = '';
    if(elem.style.display != 'none') {
      display = 'none';
      indicator = '&#x25b6;';
    } else {
      display = 'inline';
      indicator = '&#x25bc;';
    }
    elem.style.display = display;
    html = indicator + html.substr(1,html.length);
    control.innerHTML = html;
  }
}
  </script>
</head>

<body onload="initialize()">
  <div id="container">
    <div id="masthead">
      <h1>Weewx</h1>
      <h3>Open source software for your weather station</h3>
    </div>

    <div id='map_container'>
      <div id='map_canvas' style='width:100%; height:500px'></div>

      <div class='details'>
        LAST_MODIFIED
      </div>
    </div>

    <div id='content'>
      <div id='instructions'>
        <div onclick="toggle(this,'instruction_details')">&#x25b6; <strong>How to Add Your Station</strong></div>
        <div id='instruction_details' style='display:none'>
          <p>
	    To add your station to this list, put the following in weewx.conf,
            then restart weewx.
	    <pre>
[Station]
    station_url = URL_TO_YOUR_STATION
[StdRESTful]
    [[StationRegistry]]
        register_this_station = True
        driver = weewx.restful.StationRegistry
	    </pre>
          </p>
        </div>
      </div>

      <div id='sites'>
        <div onclick="toggle(this,'site_listing')">&#x25b6; <strong>Weather Stations Running weewx</strong></div>
        <div id='site_listing' style='display:none'></div>
      </div>

    </div>

    <div id="footer">
      <p>
        <a href="index.htm">Home</a> | 
        <a href="https://sourceforge.net/projects/weewx/files/">Downloads</a> |
        <a href="docs/">Documentation</a> | 
        <a href="docs/changes.txt">Changes</a> | 
        <a href="https://sourceforge.net/projects/weewx/"><span class="code">weewx</span> on SourceForge</a> | 
        <a href="http://groups.google.com/group/weewx-user">Users&#39; Group</a>
      </p>
    </div>
      
  <script type='text/javascript'>
var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.');
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type='text/javascript'>
try {
  var pageTracker = _gat._getTracker('UA-11386156-1');
  pageTracker._trackPageview();
} catch(err) {}
  </script>  
</body>
</html>
